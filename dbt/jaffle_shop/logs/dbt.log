[0m15:49:11.266736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743bed0>]}


============================== 15:49:11.269201 | 69d4f019-eda2-4777-8a4c-004fbfe1bc11 ==============================
[0m15:49:11.269201 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:49:11.269491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m15:49:11.341251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69d4f019-eda2-4777-8a4c-004fbfe1bc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107996780>]}
[0m15:49:11.362811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69d4f019-eda2-4777-8a4c-004fbfe1bc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730bac0>]}
[0m15:49:11.364148 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:49:11.408802 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:49:11.409176 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:49:11.409335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '69d4f019-eda2-4777-8a4c-004fbfe1bc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d7b50>]}
[0m15:49:11.927468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69d4f019-eda2-4777-8a4c-004fbfe1bc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108083e30>]}
[0m15:49:11.961998 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/manifest.json
[0m15:49:11.963568 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/semantic_manifest.json
[0m15:49:11.972677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69d4f019-eda2-4777-8a4c-004fbfe1bc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084098d0>]}
[0m15:49:11.972947 [info ] [MainThread]: Found 5 models, 3 seeds, 20 data tests, 433 macros
[0m15:49:11.973099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69d4f019-eda2-4777-8a4c-004fbfe1bc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10755aa90>]}
[0m15:49:11.974007 [info ] [MainThread]: 
[0m15:49:11.974161 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:49:11.974279 [info ] [MainThread]: 
[0m15:49:11.974482 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:49:11.976183 [debug] [ThreadPool]: Acquiring new postgres connection 'list_cosmos'
[0m15:49:12.013801 [debug] [ThreadPool]: Using postgres connection "list_cosmos"
[0m15:49:12.014036 [debug] [ThreadPool]: On list_cosmos: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "connection_name": "list_cosmos"} */

    select distinct nspname from pg_namespace
  
[0m15:49:12.014165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:12.032091 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.018 seconds
[0m15:49:12.032798 [debug] [ThreadPool]: On list_cosmos: Close
[0m15:49:12.033607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cosmos, now list_cosmos_dbt)
[0m15:49:12.036098 [debug] [ThreadPool]: Using postgres connection "list_cosmos_dbt"
[0m15:49:12.036318 [debug] [ThreadPool]: On list_cosmos_dbt: BEGIN
[0m15:49:12.036456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:12.039678 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:49:12.039871 [debug] [ThreadPool]: Using postgres connection "list_cosmos_dbt"
[0m15:49:12.040000 [debug] [ThreadPool]: On list_cosmos_dbt: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "connection_name": "list_cosmos_dbt"} */
select
      'cosmos' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'cosmos' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'cosmos' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m15:49:12.041422 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.001 seconds
[0m15:49:12.042026 [debug] [ThreadPool]: On list_cosmos_dbt: ROLLBACK
[0m15:49:12.042314 [debug] [ThreadPool]: On list_cosmos_dbt: Close
[0m15:49:12.044767 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:12.044929 [debug] [MainThread]: On master: BEGIN
[0m15:49:12.045034 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:49:12.048336 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:49:12.048504 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:12.048665 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:49:12.053727 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m15:49:12.054511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69d4f019-eda2-4777-8a4c-004fbfe1bc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108475fd0>]}
[0m15:49:12.054710 [debug] [MainThread]: On master: ROLLBACK
[0m15:49:12.055065 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:12.055176 [debug] [MainThread]: On master: BEGIN
[0m15:49:12.055740 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:49:12.055871 [debug] [MainThread]: On master: COMMIT
[0m15:49:12.055984 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:12.056090 [debug] [MainThread]: On master: COMMIT
[0m15:49:12.056400 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:49:12.056525 [debug] [MainThread]: On master: Close
[0m15:49:12.059629 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m15:49:12.059836 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m15:49:12.059991 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m15:49:12.060211 [info ] [Thread-2 (]: 2 of 3 START seed file dbt.raw_orders .......................................... [RUN]
[0m15:49:12.060419 [info ] [Thread-3 (]: 3 of 3 START seed file dbt.raw_payments ........................................ [RUN]
[0m15:49:12.060626 [info ] [Thread-1 (]: 1 of 3 START seed file dbt.raw_customers ....................................... [RUN]
[0m15:49:12.060845 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.jaffle_shop.raw_orders'
[0m15:49:12.061046 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.jaffle_shop.raw_payments'
[0m15:49:12.061225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cosmos_dbt, now seed.jaffle_shop.raw_customers)
[0m15:49:12.061373 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m15:49:12.061518 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m15:49:12.061659 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m15:49:12.061802 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m15:49:12.061939 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m15:49:12.062076 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m15:49:12.078121 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m15:49:12.078916 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m15:49:12.079891 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: BEGIN
[0m15:49:12.080684 [debug] [Thread-3 (]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m15:49:12.080829 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: BEGIN
[0m15:49:12.080974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:12.081107 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: BEGIN
[0m15:49:12.081229 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:49:12.081416 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:49:12.085260 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m15:49:12.085481 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m15:49:12.085623 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:49:12.085754 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m15:49:12.085908 [debug] [Thread-3 (]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m15:49:12.086086 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m15:49:12.086258 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
truncate table "cosmos"."dbt"."raw_orders"
[0m15:49:12.086400 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
truncate table "cosmos"."dbt"."raw_payments"
[0m15:49:12.086535 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
truncate table "cosmos"."dbt"."raw_customers"
[0m15:49:12.097885 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.011 seconds
[0m15:49:12.105575 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.019 seconds
[0m15:49:12.105764 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.019 seconds
[0m15:49:12.111245 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m15:49:12.121134 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m15:49:12.131281 [debug] [Thread-3 (]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m15:49:12.131455 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: 
          insert into "cosmos"."dbt"."raw_customers" ("id", "first_name", "last_name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),...
[0m15:49:12.131625 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: 
          insert into "cosmos"."dbt"."raw_orders" ("id", "user_id", "order_date", "status") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,...
[0m15:49:12.131770 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: 
          insert into "cosmos"."dbt"."raw_payments" ("id", "order_id", "payment_method", "amount") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s...
[0m15:49:12.132831 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m15:49:12.133001 [debug] [Thread-2 (]: SQL status: INSERT 0 99 in 0.001 seconds
[0m15:49:12.135384 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m15:49:12.135550 [debug] [Thread-3 (]: SQL status: INSERT 0 113 in 0.003 seconds
[0m15:49:12.135777 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m15:49:12.136072 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m15:49:12.142048 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m15:49:12.142612 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m15:49:12.143042 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: COMMIT
[0m15:49:12.143183 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m15:49:12.143330 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m15:49:12.143471 [debug] [Thread-3 (]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m15:49:12.143604 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m15:49:12.143749 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m15:49:12.143902 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: COMMIT
[0m15:49:12.146193 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:49:12.146385 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:49:12.147438 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m15:49:12.147604 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m15:49:12.147888 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m15:49:12.148201 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m15:49:12.149413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69d4f019-eda2-4777-8a4c-004fbfe1bc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108799230>]}
[0m15:49:12.149563 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69d4f019-eda2-4777-8a4c-004fbfe1bc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109857e30>]}
[0m15:49:12.149748 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69d4f019-eda2-4777-8a4c-004fbfe1bc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109987c80>]}
[0m15:49:12.149950 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file dbt.raw_customers ................................... [[32mINSERT 100[0m in 0.09s]
[0m15:49:12.150151 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file dbt.raw_orders ...................................... [[32mINSERT 99[0m in 0.09s]
[0m15:49:12.150661 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m15:49:12.150400 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file dbt.raw_payments .................................... [[32mINSERT 113[0m in 0.09s]
[0m15:49:12.150926 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m15:49:12.151188 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m15:49:12.151830 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:12.151966 [debug] [MainThread]: On master: BEGIN
[0m15:49:12.152080 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:49:12.154738 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:49:12.154920 [debug] [MainThread]: On master: COMMIT
[0m15:49:12.155046 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:12.155156 [debug] [MainThread]: On master: COMMIT
[0m15:49:12.155396 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:49:12.155510 [debug] [MainThread]: On master: Close
[0m15:49:12.155858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:12.155991 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m15:49:12.156144 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m15:49:12.156240 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m15:49:12.156374 [info ] [MainThread]: 
[0m15:49:12.156513 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m15:49:12.156957 [debug] [MainThread]: Command end result
[0m15:49:12.167129 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/manifest.json
[0m15:49:12.168121 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/semantic_manifest.json
[0m15:49:12.170934 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/run_results.json
[0m15:49:12.171127 [info ] [MainThread]: 
[0m15:49:12.171290 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:49:12.171409 [info ] [MainThread]: 
[0m15:49:12.171530 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:49:12.172405 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.9340884, "process_in_blocks": "0", "process_kernel_time": 0.176993, "process_mem_max_rss": "134348800", "process_out_blocks": "0", "process_user_time": 1.257039}
[0m15:49:12.172585 [debug] [MainThread]: Command `dbt seed` succeeded at 15:49:12.172548 after 0.93 seconds
[0m15:49:12.172738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748db00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033b00c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e9190>]}
[0m15:49:12.172897 [debug] [MainThread]: Flushing usage events
[0m15:49:13.205533 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:49:16.747112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b2fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b2fed0>]}


============================== 15:49:16.749867 | f5d3e258-ef1b-45f3-959c-08a2b404df72 ==============================
[0m15:49:16.749867 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:49:16.750163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:49:16.818071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5d3e258-ef1b-45f3-959c-08a2b404df72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10908a780>]}
[0m15:49:16.840746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5d3e258-ef1b-45f3-959c-08a2b404df72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ffac0>]}
[0m15:49:16.842029 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:49:16.888099 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:49:16.945020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:49:16.945234 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:49:16.963851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5d3e258-ef1b-45f3-959c-08a2b404df72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10970e850>]}
[0m15:49:16.995335 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/manifest.json
[0m15:49:16.996628 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/semantic_manifest.json
[0m15:49:17.003528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5d3e258-ef1b-45f3-959c-08a2b404df72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba2300>]}
[0m15:49:17.003762 [info ] [MainThread]: Found 5 models, 3 seeds, 20 data tests, 433 macros
[0m15:49:17.003918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5d3e258-ef1b-45f3-959c-08a2b404df72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1235b0>]}
[0m15:49:17.004820 [info ] [MainThread]: 
[0m15:49:17.004976 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:49:17.005094 [info ] [MainThread]: 
[0m15:49:17.005312 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:49:17.006973 [debug] [ThreadPool]: Acquiring new postgres connection 'list_cosmos'
[0m15:49:17.038809 [debug] [ThreadPool]: Using postgres connection "list_cosmos"
[0m15:49:17.039021 [debug] [ThreadPool]: On list_cosmos: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "connection_name": "list_cosmos"} */

    select distinct nspname from pg_namespace
  
[0m15:49:17.039144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:17.049663 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m15:49:17.050290 [debug] [ThreadPool]: On list_cosmos: Close
[0m15:49:17.051026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cosmos, now list_cosmos_dbt)
[0m15:49:17.053422 [debug] [ThreadPool]: Using postgres connection "list_cosmos_dbt"
[0m15:49:17.053592 [debug] [ThreadPool]: On list_cosmos_dbt: BEGIN
[0m15:49:17.053714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:17.056814 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:49:17.056978 [debug] [ThreadPool]: Using postgres connection "list_cosmos_dbt"
[0m15:49:17.057103 [debug] [ThreadPool]: On list_cosmos_dbt: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "connection_name": "list_cosmos_dbt"} */
select
      'cosmos' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'cosmos' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'cosmos' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m15:49:17.058256 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.001 seconds
[0m15:49:17.058827 [debug] [ThreadPool]: On list_cosmos_dbt: ROLLBACK
[0m15:49:17.059124 [debug] [ThreadPool]: On list_cosmos_dbt: Close
[0m15:49:17.061392 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:17.061519 [debug] [MainThread]: On master: BEGIN
[0m15:49:17.061618 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:49:17.064218 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:49:17.064351 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:17.064495 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:49:17.069008 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m15:49:17.069743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5d3e258-ef1b-45f3-959c-08a2b404df72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a1e60>]}
[0m15:49:17.069930 [debug] [MainThread]: On master: ROLLBACK
[0m15:49:17.070257 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:17.070389 [debug] [MainThread]: On master: BEGIN
[0m15:49:17.070875 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:49:17.070995 [debug] [MainThread]: On master: COMMIT
[0m15:49:17.071103 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:17.071200 [debug] [MainThread]: On master: COMMIT
[0m15:49:17.071470 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:49:17.071586 [debug] [MainThread]: On master: Close
[0m15:49:17.072779 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m15:49:17.073298 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m15:49:17.073647 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m15:49:17.073523 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt.stg_orders ..................................... [RUN]
[0m15:49:17.073880 [info ] [Thread-3 (]: 3 of 5 START sql view model dbt.stg_payments ................................... [RUN]
[0m15:49:17.074068 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt.stg_customers .................................. [RUN]
[0m15:49:17.074299 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_orders'
[0m15:49:17.074504 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_payments'
[0m15:49:17.074655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cosmos_dbt, now model.jaffle_shop.stg_customers)
[0m15:49:17.074797 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m15:49:17.074928 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m15:49:17.075059 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m15:49:17.078178 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m15:49:17.079258 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m15:49:17.080413 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m15:49:17.081062 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m15:49:17.081227 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m15:49:17.086712 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m15:49:17.096308 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m15:49:17.096721 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m15:49:17.097746 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m15:49:17.098304 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m15:49:17.098444 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m15:49:17.098606 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m15:49:17.098760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:17.098906 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m15:49:17.099037 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m15:49:17.099231 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m15:49:17.099364 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:49:17.099493 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:49:17.102915 [debug] [Thread-3 (]: SQL status: BEGIN in 0.003 seconds
[0m15:49:17.103137 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:49:17.103314 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m15:49:17.103461 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m15:49:17.103620 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m15:49:17.103760 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m15:49:17.103904 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "cosmos"."dbt"."stg_payments__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "cosmos"."dbt"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
[0m15:49:17.104060 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "cosmos"."dbt"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "cosmos"."dbt"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
[0m15:49:17.104210 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "cosmos"."dbt"."stg_orders__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "cosmos"."dbt"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
[0m15:49:17.105847 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:49:17.106009 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:49:17.108841 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m15:49:17.108992 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m15:49:17.110150 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m15:49:17.110321 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "cosmos"."dbt"."stg_customers" rename to "stg_customers__dbt_backup"
[0m15:49:17.111514 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m15:49:17.111687 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "cosmos"."dbt"."stg_orders" rename to "stg_orders__dbt_backup"
[0m15:49:17.111873 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "cosmos"."dbt"."stg_payments" rename to "stg_payments__dbt_backup"
[0m15:49:17.112398 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:49:17.112532 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:49:17.113692 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m15:49:17.113820 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:49:17.114831 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m15:49:17.114984 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "cosmos"."dbt"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m15:49:17.115877 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m15:49:17.116017 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "cosmos"."dbt"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m15:49:17.116170 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "cosmos"."dbt"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:49:17.116557 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:49:17.116697 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:49:17.116824 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:49:17.123511 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m15:49:17.124087 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m15:49:17.124542 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m15:49:17.124698 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m15:49:17.124842 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m15:49:17.124972 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m15:49:17.125103 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m15:49:17.125228 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m15:49:17.125352 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m15:49:17.127492 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:49:17.127663 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:49:17.130372 [debug] [Thread-3 (]: Applying DROP to: "cosmos"."dbt"."stg_payments__dbt_backup"
[0m15:49:17.130546 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m15:49:17.131361 [debug] [Thread-1 (]: Applying DROP to: "cosmos"."dbt"."stg_customers__dbt_backup"
[0m15:49:17.133534 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m15:49:17.134299 [debug] [Thread-2 (]: Applying DROP to: "cosmos"."dbt"."stg_orders__dbt_backup"
[0m15:49:17.134506 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m15:49:17.134648 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "cosmos"."dbt"."stg_payments__dbt_backup" cascade
[0m15:49:17.134852 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m15:49:17.134992 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "cosmos"."dbt"."stg_customers__dbt_backup" cascade
[0m15:49:17.135196 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "cosmos"."dbt"."stg_orders__dbt_backup" cascade
[0m15:49:17.137308 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:49:17.138488 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m15:49:17.138667 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:49:17.138844 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m15:49:17.139374 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m15:49:17.140572 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m15:49:17.141098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5d3e258-ef1b-45f3-959c-08a2b404df72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1b34d0>]}
[0m15:49:17.141263 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5d3e258-ef1b-45f3-959c-08a2b404df72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c4940>]}
[0m15:49:17.141691 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5d3e258-ef1b-45f3-959c-08a2b404df72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108012850>]}
[0m15:49:17.141557 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt.stg_customers ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m15:49:17.142413 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m15:49:17.141958 [info ] [Thread-3 (]: 3 of 5 OK created sql view model dbt.stg_payments .............................. [[32mCREATE VIEW[0m in 0.07s]
[0m15:49:17.142157 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt.stg_orders ................................ [[32mCREATE VIEW[0m in 0.07s]
[0m15:49:17.142830 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m15:49:17.143028 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m15:49:17.143381 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m15:49:17.143547 [debug] [Thread-1 (]: Began running node model.jaffle_shop.orders
[0m15:49:17.143734 [info ] [Thread-4 (]: 4 of 5 START sql table model dbt.customers ..................................... [RUN]
[0m15:49:17.143957 [info ] [Thread-1 (]: 5 of 5 START sql table model dbt.orders ........................................ [RUN]
[0m15:49:17.144192 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.jaffle_shop.customers'
[0m15:49:17.144349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.orders)
[0m15:49:17.144500 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m15:49:17.144637 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.orders
[0m15:49:17.146127 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m15:49:17.147950 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.orders"
[0m15:49:17.148447 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m15:49:17.148656 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.orders
[0m15:49:17.157619 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m15:49:17.159089 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.orders"
[0m15:49:17.159586 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.orders"
[0m15:49:17.159735 [debug] [Thread-1 (]: On model.jaffle_shop.orders: BEGIN
[0m15:49:17.159896 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.customers"
[0m15:49:17.160045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:17.160197 [debug] [Thread-4 (]: On model.jaffle_shop.customers: BEGIN
[0m15:49:17.160420 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:49:17.163728 [debug] [Thread-4 (]: SQL status: BEGIN in 0.003 seconds
[0m15:49:17.163936 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:49:17.164104 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.customers"
[0m15:49:17.164256 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.orders"
[0m15:49:17.164429 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  
    

  create  table "cosmos"."dbt"."customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (

    select * from "cosmos"."dbt"."stg_customers"

),

orders as (

    select * from "cosmos"."dbt"."stg_orders"

),

payments as (

    select * from "cosmos"."dbt"."stg_payments"

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
  
[0m15:49:17.164619 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */

  
    

  create  table "cosmos"."dbt"."orders__dbt_tmp"
  
  
    as
  
  (
    

with orders as (

    select * from "cosmos"."dbt"."stg_orders"

),

payments as (

    select * from "cosmos"."dbt"."stg_payments"

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final
  );
  
[0m15:49:17.169126 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.004 seconds
[0m15:49:17.169306 [debug] [Thread-4 (]: SQL status: SELECT 100 in 0.005 seconds
[0m15:49:17.172055 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.orders"
[0m15:49:17.173206 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.customers"
[0m15:49:17.173370 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */
alter table "cosmos"."dbt"."orders" rename to "orders__dbt_backup"
[0m15:49:17.173520 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "cosmos"."dbt"."customers" rename to "customers__dbt_backup"
[0m15:49:17.174167 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:49:17.174334 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:49:17.175622 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.customers"
[0m15:49:17.176576 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.orders"
[0m15:49:17.176724 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "cosmos"."dbt"."customers__dbt_tmp" rename to "customers"
[0m15:49:17.176871 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */
alter table "cosmos"."dbt"."orders__dbt_tmp" rename to "orders"
[0m15:49:17.177341 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:49:17.177482 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:49:17.177970 [debug] [Thread-4 (]: On model.jaffle_shop.customers: COMMIT
[0m15:49:17.178438 [debug] [Thread-1 (]: On model.jaffle_shop.orders: COMMIT
[0m15:49:17.178582 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.customers"
[0m15:49:17.178714 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.orders"
[0m15:49:17.178841 [debug] [Thread-4 (]: On model.jaffle_shop.customers: COMMIT
[0m15:49:17.178963 [debug] [Thread-1 (]: On model.jaffle_shop.orders: COMMIT
[0m15:49:17.181430 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m15:49:17.182535 [debug] [Thread-4 (]: Applying DROP to: "cosmos"."dbt"."customers__dbt_backup"
[0m15:49:17.184369 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.customers"
[0m15:49:17.184513 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m15:49:17.184645 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

    DROP TABLE IF EXISTS dbt."cosmos"."dbt"."customers__dbt_backup" CASCADE
  
[0m15:49:17.185319 [debug] [Thread-1 (]: Applying DROP to: "cosmos"."dbt"."orders__dbt_backup"
[0m15:49:17.185583 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.orders"
[0m15:49:17.185729 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */

    DROP TABLE IF EXISTS dbt."cosmos"."dbt"."orders__dbt_backup" CASCADE
  
[0m15:49:17.185898 [debug] [Thread-4 (]: Postgres adapter: Postgres error: improper relation name (too many dotted names): dbt.cosmos.dbt.customers__dbt_backup

[0m15:49:17.186122 [debug] [Thread-4 (]: Postgres adapter: Error running SQL: macro drop_relation
[0m15:49:17.186251 [debug] [Thread-4 (]: Postgres adapter: Rolling back transaction.
[0m15:49:17.186382 [debug] [Thread-1 (]: Postgres adapter: Postgres error: improper relation name (too many dotted names): dbt.cosmos.dbt.orders__dbt_backup

[0m15:49:17.186531 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m15:49:17.186710 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro drop_relation
[0m15:49:17.186867 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:49:17.188267 [debug] [Thread-1 (]: On model.jaffle_shop.orders: Close
[0m15:49:17.198783 [debug] [Thread-4 (]: Database Error in model customers (models/customers/customers.sql)
  improper relation name (too many dotted names): dbt.cosmos.dbt.customers__dbt_backup
  compiled code at target/run/jaffle_shop/models/customers/customers.sql
[0m15:49:17.199064 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5d3e258-ef1b-45f3-959c-08a2b404df72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110985250>]}
[0m15:49:17.199630 [debug] [Thread-1 (]: Database Error in model orders (models/orders.sql)
  improper relation name (too many dotted names): dbt.cosmos.dbt.orders__dbt_backup
  compiled code at target/run/jaffle_shop/models/orders.sql
[0m15:49:17.200048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5d3e258-ef1b-45f3-959c-08a2b404df72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1324a0>]}
[0m15:49:17.199908 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model dbt.customers ............................ [[31mERROR[0m in 0.05s]
[0m15:49:17.200500 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m15:49:17.200323 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model dbt.orders ............................... [[31mERROR[0m in 0.06s]
[0m15:49:17.200743 [debug] [Thread-7 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (models/customers/customers.sql)
  improper relation name (too many dotted names): dbt.cosmos.dbt.customers__dbt_backup
  compiled code at target/run/jaffle_shop/models/customers/customers.sql.
[0m15:49:17.200933 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.orders
[0m15:49:17.201428 [debug] [Thread-7 (]: Marking all children of 'model.jaffle_shop.orders' to be skipped because of status 'error'.  Reason: Database Error in model orders (models/orders.sql)
  improper relation name (too many dotted names): dbt.cosmos.dbt.orders__dbt_backup
  compiled code at target/run/jaffle_shop/models/orders.sql.
[0m15:49:17.201997 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:17.202116 [debug] [MainThread]: On master: BEGIN
[0m15:49:17.202219 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:49:17.205264 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:49:17.205406 [debug] [MainThread]: On master: COMMIT
[0m15:49:17.205532 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:17.205645 [debug] [MainThread]: On master: COMMIT
[0m15:49:17.205970 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:49:17.206087 [debug] [MainThread]: On master: Close
[0m15:49:17.206251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:17.206367 [debug] [MainThread]: Connection 'model.jaffle_shop.orders' was properly closed.
[0m15:49:17.206471 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m15:49:17.206606 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m15:49:17.206700 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m15:49:17.206868 [info ] [MainThread]: 
[0m15:49:17.207007 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m15:49:17.207484 [debug] [MainThread]: Command end result
[0m15:49:17.247507 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/manifest.json
[0m15:49:17.248338 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/semantic_manifest.json
[0m15:49:17.250831 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/run_results.json
[0m15:49:17.250975 [info ] [MainThread]: 
[0m15:49:17.251126 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:49:17.251249 [info ] [MainThread]: 
[0m15:49:17.251391 [error] [MainThread]:   Database Error in model customers (models/customers/customers.sql)
  improper relation name (too many dotted names): dbt.cosmos.dbt.customers__dbt_backup
  compiled code at target/run/jaffle_shop/models/customers/customers.sql
[0m15:49:17.251512 [info ] [MainThread]: 
[0m15:49:17.251639 [error] [MainThread]:   Database Error in model orders (models/orders.sql)
  improper relation name (too many dotted names): dbt.cosmos.dbt.orders__dbt_backup
  compiled code at target/run/jaffle_shop/models/orders.sql
[0m15:49:17.251751 [info ] [MainThread]: 
[0m15:49:17.251880 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m15:49:17.253029 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5375121, "process_in_blocks": "0", "process_kernel_time": 0.175528, "process_mem_max_rss": "126173184", "process_out_blocks": "0", "process_user_time": 0.901473}
[0m15:49:17.253207 [debug] [MainThread]: Command `dbt run` failed at 15:49:17.253169 after 0.54 seconds
[0m15:49:17.253370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c477d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c47cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c47710>]}
[0m15:49:17.253518 [debug] [MainThread]: Flushing usage events
[0m15:49:18.428265 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:52:05.391573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bbed0>]}


============================== 15:52:05.394516 | 087d549d-1d60-4aa0-910f-f6caa2e4689b ==============================
[0m15:52:05.394516 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:52:05.394808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop', 'log_path': '/Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ls', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:52:05.469496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '087d549d-1d60-4aa0-910f-f6caa2e4689b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063de780>]}
[0m15:52:05.491338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '087d549d-1d60-4aa0-910f-f6caa2e4689b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f8fac0>]}
[0m15:52:05.491969 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:52:05.536447 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:52:05.593855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:52:05.594029 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:52:05.612116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '087d549d-1d60-4aa0-910f-f6caa2e4689b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c22850>]}
[0m15:52:05.644000 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/manifest.json
[0m15:52:05.645500 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/semantic_manifest.json
[0m15:52:05.656752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '087d549d-1d60-4aa0-910f-f6caa2e4689b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ced310>]}
[0m15:52:05.656986 [info ] [MainThread]: Found 5 models, 3 seeds, 20 data tests, 433 macros
[0m15:52:05.657134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '087d549d-1d60-4aa0-910f-f6caa2e4689b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dfb690>]}
[0m15:52:05.657597 [info ] [MainThread]: jaffle_shop.customers.customers
[0m15:52:05.657731 [info ] [MainThread]: jaffle_shop.orders
[0m15:52:05.657834 [info ] [MainThread]: jaffle_shop.staging.stg_customers
[0m15:52:05.657940 [info ] [MainThread]: jaffle_shop.staging.stg_orders
[0m15:52:05.658041 [info ] [MainThread]: jaffle_shop.staging.stg_payments
[0m15:52:05.658143 [info ] [MainThread]: jaffle_shop.raw_customers
[0m15:52:05.658237 [info ] [MainThread]: jaffle_shop.raw_orders
[0m15:52:05.658334 [info ] [MainThread]: jaffle_shop.raw_payments
[0m15:52:05.658427 [info ] [MainThread]: jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned
[0m15:52:05.658526 [info ] [MainThread]: jaffle_shop.staging.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
[0m15:52:05.658627 [info ] [MainThread]: jaffle_shop.staging.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card
[0m15:52:05.658725 [info ] [MainThread]: jaffle_shop.not_null_customers_customer_id
[0m15:52:05.658826 [info ] [MainThread]: jaffle_shop.not_null_orders_amount
[0m15:52:05.658923 [info ] [MainThread]: jaffle_shop.not_null_orders_bank_transfer_amount
[0m15:52:05.659014 [info ] [MainThread]: jaffle_shop.not_null_orders_coupon_amount
[0m15:52:05.659109 [info ] [MainThread]: jaffle_shop.not_null_orders_credit_card_amount
[0m15:52:05.659204 [info ] [MainThread]: jaffle_shop.not_null_orders_customer_id
[0m15:52:05.659296 [info ] [MainThread]: jaffle_shop.not_null_orders_gift_card_amount
[0m15:52:05.659395 [info ] [MainThread]: jaffle_shop.not_null_orders_order_id
[0m15:52:05.659486 [info ] [MainThread]: jaffle_shop.staging.not_null_stg_customers_customer_id
[0m15:52:05.659586 [info ] [MainThread]: jaffle_shop.staging.not_null_stg_orders_order_id
[0m15:52:05.659689 [info ] [MainThread]: jaffle_shop.staging.not_null_stg_payments_payment_id
[0m15:52:05.659784 [info ] [MainThread]: jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_
[0m15:52:05.659877 [info ] [MainThread]: jaffle_shop.unique_customers_customer_id
[0m15:52:05.659968 [info ] [MainThread]: jaffle_shop.unique_orders_order_id
[0m15:52:05.660062 [info ] [MainThread]: jaffle_shop.staging.unique_stg_customers_customer_id
[0m15:52:05.660154 [info ] [MainThread]: jaffle_shop.staging.unique_stg_orders_order_id
[0m15:52:05.660244 [info ] [MainThread]: jaffle_shop.staging.unique_stg_payments_payment_id
[0m15:52:05.661278 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.30103457, "process_in_blocks": "0", "process_kernel_time": 0.14839, "process_mem_max_rss": "113967104", "process_out_blocks": "0", "process_user_time": 0.685979}
[0m15:52:05.661451 [debug] [MainThread]: Command `dbt ls` succeeded at 15:52:05.661410 after 0.30 seconds
[0m15:52:05.661614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ddb860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106debe90>]}
[0m15:52:05.661752 [debug] [MainThread]: Flushing usage events
[0m15:52:07.124401 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:55:38.845593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120bc5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ebbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ebbed0>]}


============================== 15:55:38.848370 | bf3437b9-37a6-4402-9fce-4da688e0dbff ==============================
[0m15:55:38.848370 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:55:38.848632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/logs', 'profiles_dir': '/Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:55:38.923579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf3437b9-37a6-4402-9fce-4da688e0dbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12236e780>]}
[0m15:55:38.944953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf3437b9-37a6-4402-9fce-4da688e0dbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d8bac0>]}
[0m15:55:38.945552 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:55:38.992884 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:55:39.052149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:55:39.052328 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:55:39.070457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf3437b9-37a6-4402-9fce-4da688e0dbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122b42850>]}
[0m15:55:39.101581 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/manifest.json
[0m15:55:39.103049 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/semantic_manifest.json
[0m15:55:39.115461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf3437b9-37a6-4402-9fce-4da688e0dbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f3a300>]}
[0m15:55:39.115708 [info ] [MainThread]: Found 5 models, 3 seeds, 20 data tests, 433 macros
[0m15:55:39.115854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf3437b9-37a6-4402-9fce-4da688e0dbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122d1b5b0>]}
[0m15:55:39.116765 [info ] [MainThread]: 
[0m15:55:39.116908 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:55:39.117020 [info ] [MainThread]: 
[0m15:55:39.117225 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:55:39.118861 [debug] [ThreadPool]: Acquiring new postgres connection 'list_cosmos'
[0m15:55:39.151924 [debug] [ThreadPool]: Using postgres connection "list_cosmos"
[0m15:55:39.152145 [debug] [ThreadPool]: On list_cosmos: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "connection_name": "list_cosmos"} */

    select distinct nspname from pg_namespace
  
[0m15:55:39.152274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:39.175897 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.024 seconds
[0m15:55:39.176551 [debug] [ThreadPool]: On list_cosmos: Close
[0m15:55:39.177294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cosmos, now list_cosmos_dbt)
[0m15:55:39.179667 [debug] [ThreadPool]: Using postgres connection "list_cosmos_dbt"
[0m15:55:39.179805 [debug] [ThreadPool]: On list_cosmos_dbt: BEGIN
[0m15:55:39.179912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:39.184768 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m15:55:39.184902 [debug] [ThreadPool]: Using postgres connection "list_cosmos_dbt"
[0m15:55:39.185022 [debug] [ThreadPool]: On list_cosmos_dbt: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "connection_name": "list_cosmos_dbt"} */
select
      'cosmos' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'cosmos' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'cosmos' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m15:55:39.188384 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m15:55:39.188925 [debug] [ThreadPool]: On list_cosmos_dbt: ROLLBACK
[0m15:55:39.189355 [debug] [ThreadPool]: On list_cosmos_dbt: Close
[0m15:55:39.191660 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:39.191811 [debug] [MainThread]: On master: BEGIN
[0m15:55:39.191923 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:55:39.197047 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m15:55:39.197165 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:39.197313 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:55:39.208165 [debug] [MainThread]: SQL status: SELECT 3 in 0.011 seconds
[0m15:55:39.208990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf3437b9-37a6-4402-9fce-4da688e0dbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12309de60>]}
[0m15:55:39.209178 [debug] [MainThread]: On master: ROLLBACK
[0m15:55:39.209605 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:39.209718 [debug] [MainThread]: On master: BEGIN
[0m15:55:39.210274 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:55:39.210415 [debug] [MainThread]: On master: COMMIT
[0m15:55:39.210527 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:39.210632 [debug] [MainThread]: On master: COMMIT
[0m15:55:39.210874 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:55:39.210994 [debug] [MainThread]: On master: Close
[0m15:55:39.212646 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m15:55:39.213240 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m15:55:39.213420 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m15:55:39.213647 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt.stg_orders ..................................... [RUN]
[0m15:55:39.213871 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt.stg_customers .................................. [RUN]
[0m15:55:39.214088 [info ] [Thread-3 (]: 3 of 5 START sql view model dbt.stg_payments ................................... [RUN]
[0m15:55:39.214323 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_orders'
[0m15:55:39.214493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cosmos_dbt, now model.jaffle_shop.stg_customers)
[0m15:55:39.214676 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_payments'
[0m15:55:39.214824 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m15:55:39.214961 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m15:55:39.215093 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m15:55:39.218255 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m15:55:39.219458 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m15:55:39.220991 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m15:55:39.221478 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m15:55:39.221639 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m15:55:39.221788 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m15:55:39.235908 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m15:55:39.236512 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m15:55:39.237556 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m15:55:39.238039 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m15:55:39.238204 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m15:55:39.238337 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m15:55:39.238469 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m15:55:39.238596 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m15:55:39.238719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:39.238840 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m15:55:39.238954 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:55:39.239133 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:55:39.242658 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m15:55:39.243846 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m15:55:39.244099 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m15:55:39.244622 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m15:55:39.244779 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "cosmos"."dbt"."stg_orders__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "cosmos"."dbt"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
[0m15:55:39.244956 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "cosmos"."dbt"."stg_payments__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "cosmos"."dbt"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
[0m15:55:39.245740 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m15:55:39.245875 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m15:55:39.246006 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "cosmos"."dbt"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "cosmos"."dbt"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
[0m15:55:39.246405 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:55:39.246566 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:55:39.249247 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m15:55:39.249397 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:55:39.250419 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m15:55:39.250549 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "cosmos"."dbt"."stg_orders" rename to "stg_orders__dbt_backup"
[0m15:55:39.251443 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m15:55:39.251587 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "cosmos"."dbt"."stg_payments" rename to "stg_payments__dbt_backup"
[0m15:55:39.251748 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "cosmos"."dbt"."stg_customers" rename to "stg_customers__dbt_backup"
[0m15:55:39.252013 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:55:39.252182 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:55:39.253239 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m15:55:39.253371 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:55:39.254202 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m15:55:39.254332 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "cosmos"."dbt"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:55:39.255110 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m15:55:39.255234 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "cosmos"."dbt"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m15:55:39.255386 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "cosmos"."dbt"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m15:55:39.255791 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:55:39.255945 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:55:39.261959 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m15:55:39.262450 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m15:55:39.262599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m15:55:39.262724 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m15:55:39.262843 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m15:55:39.263237 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m15:55:39.263366 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m15:55:39.263489 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m15:55:39.263615 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m15:55:39.263789 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m15:55:39.265885 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:55:39.268293 [debug] [Thread-2 (]: Applying DROP to: "cosmos"."dbt"."stg_orders__dbt_backup"
[0m15:55:39.268443 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m15:55:39.268569 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m15:55:39.270276 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m15:55:39.271128 [debug] [Thread-1 (]: Applying DROP to: "cosmos"."dbt"."stg_customers__dbt_backup"
[0m15:55:39.271753 [debug] [Thread-3 (]: Applying DROP to: "cosmos"."dbt"."stg_payments__dbt_backup"
[0m15:55:39.271886 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "cosmos"."dbt"."stg_orders__dbt_backup" cascade
[0m15:55:39.272074 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m15:55:39.272249 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m15:55:39.272390 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "cosmos"."dbt"."stg_customers__dbt_backup" cascade
[0m15:55:39.272543 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "cosmos"."dbt"."stg_payments__dbt_backup" cascade
[0m15:55:39.274642 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:55:39.275818 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m15:55:39.275993 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:55:39.276122 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:55:39.276872 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m15:55:39.277608 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m15:55:39.278311 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf3437b9-37a6-4402-9fce-4da688e0dbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122db3890>]}
[0m15:55:39.278464 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf3437b9-37a6-4402-9fce-4da688e0dbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1230c19c0>]}
[0m15:55:39.278626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf3437b9-37a6-4402-9fce-4da688e0dbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f9e850>]}
[0m15:55:39.278847 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt.stg_orders ................................ [[32mCREATE VIEW[0m in 0.06s]
[0m15:55:39.279512 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m15:55:39.279072 [info ] [Thread-3 (]: 3 of 5 OK created sql view model dbt.stg_payments .............................. [[32mCREATE VIEW[0m in 0.06s]
[0m15:55:39.279789 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m15:55:39.279315 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt.stg_customers ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m15:55:39.280042 [debug] [Thread-4 (]: Began running node model.jaffle_shop.orders
[0m15:55:39.280223 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m15:55:39.280381 [info ] [Thread-4 (]: 4 of 5 START sql table model dbt.orders ........................................ [RUN]
[0m15:55:39.280648 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.jaffle_shop.orders'
[0m15:55:39.280789 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.orders
[0m15:55:39.280928 [debug] [Thread-2 (]: Began running node model.jaffle_shop.customers
[0m15:55:39.282327 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.orders"
[0m15:55:39.282496 [info ] [Thread-2 (]: 5 of 5 START sql table model dbt.customers ..................................... [RUN]
[0m15:55:39.282689 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.customers)
[0m15:55:39.282817 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.customers
[0m15:55:39.284219 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m15:55:39.284458 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.orders
[0m15:55:39.289516 [debug] [Thread-4 (]: Applying DROP to: "cosmos"."dbt"."orders__dbt_backup"
[0m15:55:39.291287 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.orders"
[0m15:55:39.291430 [debug] [Thread-4 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */

    DROP TABLE IF EXISTS dbt."cosmos"."dbt"."orders__dbt_backup" CASCADE
  
[0m15:55:39.291573 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.customers
[0m15:55:39.291699 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:55:39.293052 [debug] [Thread-2 (]: Applying DROP to: "cosmos"."dbt"."customers__dbt_backup"
[0m15:55:39.293352 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.customers"
[0m15:55:39.293486 [debug] [Thread-2 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

    DROP TABLE IF EXISTS dbt."cosmos"."dbt"."customers__dbt_backup" CASCADE
  
[0m15:55:39.293607 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:55:39.297717 [debug] [Thread-2 (]: Postgres adapter: Postgres error: improper relation name (too many dotted names): dbt.cosmos.dbt.customers__dbt_backup

[0m15:55:39.297880 [debug] [Thread-4 (]: Postgres adapter: Postgres error: improper relation name (too many dotted names): dbt.cosmos.dbt.orders__dbt_backup

[0m15:55:39.298089 [debug] [Thread-2 (]: Postgres adapter: Error running SQL: macro drop_relation
[0m15:55:39.298427 [debug] [Thread-4 (]: Postgres adapter: Error running SQL: macro drop_relation
[0m15:55:39.298562 [debug] [Thread-2 (]: Postgres adapter: Rolling back transaction.
[0m15:55:39.298691 [debug] [Thread-4 (]: Postgres adapter: Rolling back transaction.
[0m15:55:39.298832 [debug] [Thread-2 (]: On model.jaffle_shop.customers: Close
[0m15:55:39.298973 [debug] [Thread-4 (]: On model.jaffle_shop.orders: Close
[0m15:55:39.310654 [debug] [Thread-2 (]: Database Error in model customers (models/customers/customers.sql)
  improper relation name (too many dotted names): dbt.cosmos.dbt.customers__dbt_backup
[0m15:55:39.311231 [debug] [Thread-4 (]: Database Error in model orders (models/orders.sql)
  improper relation name (too many dotted names): dbt.cosmos.dbt.orders__dbt_backup
[0m15:55:39.311456 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf3437b9-37a6-4402-9fce-4da688e0dbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233b0150>]}
[0m15:55:39.311635 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf3437b9-37a6-4402-9fce-4da688e0dbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233b0050>]}
[0m15:55:39.311914 [error] [Thread-2 (]: 5 of 5 ERROR creating sql table model dbt.customers ............................ [[31mERROR[0m in 0.03s]
[0m15:55:39.312358 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.customers
[0m15:55:39.312174 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model dbt.orders ............................... [[31mERROR[0m in 0.03s]
[0m15:55:39.312601 [debug] [Thread-7 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (models/customers/customers.sql)
  improper relation name (too many dotted names): dbt.cosmos.dbt.customers__dbt_backup.
[0m15:55:39.312800 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.orders
[0m15:55:39.313278 [debug] [Thread-7 (]: Marking all children of 'model.jaffle_shop.orders' to be skipped because of status 'error'.  Reason: Database Error in model orders (models/orders.sql)
  improper relation name (too many dotted names): dbt.cosmos.dbt.orders__dbt_backup.
[0m15:55:39.313824 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:39.313949 [debug] [MainThread]: On master: BEGIN
[0m15:55:39.314054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:55:39.316549 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:55:39.316705 [debug] [MainThread]: On master: COMMIT
[0m15:55:39.316823 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:39.316928 [debug] [MainThread]: On master: COMMIT
[0m15:55:39.317171 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:55:39.317278 [debug] [MainThread]: On master: Close
[0m15:55:39.317436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:39.317538 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m15:55:39.317632 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m15:55:39.317722 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m15:55:39.317810 [debug] [MainThread]: Connection 'model.jaffle_shop.orders' was properly closed.
[0m15:55:39.317951 [info ] [MainThread]: 
[0m15:55:39.318089 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m15:55:39.318553 [debug] [MainThread]: Command end result
[0m15:55:39.356919 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/manifest.json
[0m15:55:39.357693 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/semantic_manifest.json
[0m15:55:39.360219 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/run_results.json
[0m15:55:39.360346 [info ] [MainThread]: 
[0m15:55:39.360490 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:55:39.360606 [info ] [MainThread]: 
[0m15:55:39.360742 [error] [MainThread]:   Database Error in model customers (models/customers/customers.sql)
  improper relation name (too many dotted names): dbt.cosmos.dbt.customers__dbt_backup
[0m15:55:39.360854 [info ] [MainThread]: 
[0m15:55:39.360977 [error] [MainThread]:   Database Error in model orders (models/orders.sql)
  improper relation name (too many dotted names): dbt.cosmos.dbt.orders__dbt_backup
[0m15:55:39.361081 [info ] [MainThread]: 
[0m15:55:39.361198 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m15:55:39.362234 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5497414, "process_in_blocks": "0", "process_kernel_time": 0.184169, "process_mem_max_rss": "125698048", "process_out_blocks": "0", "process_user_time": 0.83542}
[0m15:55:39.362398 [debug] [MainThread]: Command `dbt run` failed at 15:55:39.362361 after 0.55 seconds
[0m15:55:39.362543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12343b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12343bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12343b6b0>]}
[0m15:55:39.362683 [debug] [MainThread]: Flushing usage events
[0m15:55:40.954179 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:56:39.494923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10536da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065bbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065bbed0>]}


============================== 15:56:39.497752 | 86ef4fb1-cc8b-4d98-afe1-6de845478e5e ==============================
[0m15:56:39.497752 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:56:39.498034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/logs', 'profiles_dir': '/Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:56:39.573013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86ef4fb1-cc8b-4d98-afe1-6de845478e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c46780>]}
[0m15:56:39.594812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86ef4fb1-cc8b-4d98-afe1-6de845478e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10648fac0>]}
[0m15:56:39.595457 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:56:39.640124 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:56:39.697576 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m15:56:39.697819 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://macros/drop_table.sql
[0m15:56:39.727636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86ef4fb1-cc8b-4d98-afe1-6de845478e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107442f50>]}
[0m15:56:39.759274 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/manifest.json
[0m15:56:39.760843 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/semantic_manifest.json
[0m15:56:39.772940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86ef4fb1-cc8b-4d98-afe1-6de845478e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10662e300>]}
[0m15:56:39.773194 [info ] [MainThread]: Found 5 models, 3 seeds, 20 data tests, 432 macros
[0m15:56:39.773353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86ef4fb1-cc8b-4d98-afe1-6de845478e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771b930>]}
[0m15:56:39.774273 [info ] [MainThread]: 
[0m15:56:39.774427 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:56:39.774545 [info ] [MainThread]: 
[0m15:56:39.774754 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:56:39.776416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_cosmos'
[0m15:56:39.808914 [debug] [ThreadPool]: Using postgres connection "list_cosmos"
[0m15:56:39.809114 [debug] [ThreadPool]: On list_cosmos: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "connection_name": "list_cosmos"} */

    select distinct nspname from pg_namespace
  
[0m15:56:39.809243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:39.833975 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.025 seconds
[0m15:56:39.837828 [debug] [ThreadPool]: On list_cosmos: Close
[0m15:56:39.838576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cosmos, now list_cosmos_dbt)
[0m15:56:39.840776 [debug] [ThreadPool]: Using postgres connection "list_cosmos_dbt"
[0m15:56:39.840908 [debug] [ThreadPool]: On list_cosmos_dbt: BEGIN
[0m15:56:39.841013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:39.846148 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m15:56:39.846304 [debug] [ThreadPool]: Using postgres connection "list_cosmos_dbt"
[0m15:56:39.846427 [debug] [ThreadPool]: On list_cosmos_dbt: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "connection_name": "list_cosmos_dbt"} */
select
      'cosmos' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'cosmos' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'cosmos' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m15:56:39.849657 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m15:56:39.850200 [debug] [ThreadPool]: On list_cosmos_dbt: ROLLBACK
[0m15:56:39.850541 [debug] [ThreadPool]: On list_cosmos_dbt: Close
[0m15:56:39.852553 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:39.852679 [debug] [MainThread]: On master: BEGIN
[0m15:56:39.852776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:56:39.856811 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:56:39.856936 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:39.857080 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:56:39.867226 [debug] [MainThread]: SQL status: SELECT 3 in 0.010 seconds
[0m15:56:39.867874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86ef4fb1-cc8b-4d98-afe1-6de845478e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081924e0>]}
[0m15:56:39.868047 [debug] [MainThread]: On master: ROLLBACK
[0m15:56:39.868409 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:39.868520 [debug] [MainThread]: On master: BEGIN
[0m15:56:39.869097 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:56:39.869222 [debug] [MainThread]: On master: COMMIT
[0m15:56:39.869333 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:39.869440 [debug] [MainThread]: On master: COMMIT
[0m15:56:39.869759 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:56:39.869873 [debug] [MainThread]: On master: Close
[0m15:56:39.871713 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m15:56:39.872225 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m15:56:39.872362 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m15:56:39.872554 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt.stg_customers .................................. [RUN]
[0m15:56:39.872782 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt.stg_orders ..................................... [RUN]
[0m15:56:39.872980 [info ] [Thread-3 (]: 3 of 5 START sql view model dbt.stg_payments ................................... [RUN]
[0m15:56:39.873164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cosmos_dbt, now model.jaffle_shop.stg_customers)
[0m15:56:39.873340 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_orders'
[0m15:56:39.873503 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_payments'
[0m15:56:39.873636 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m15:56:39.873762 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m15:56:39.873882 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m15:56:39.876881 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m15:56:39.877854 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m15:56:39.878969 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m15:56:39.879360 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m15:56:39.879526 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m15:56:39.885975 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m15:56:39.894423 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m15:56:39.895324 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m15:56:39.896477 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m15:56:39.896934 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m15:56:39.897099 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m15:56:39.897241 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m15:56:39.897370 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m15:56:39.897498 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m15:56:39.897617 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m15:56:39.897758 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:56:39.897906 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:56:39.898032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:39.902847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:56:39.903045 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m15:56:39.903199 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m15:56:39.903359 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m15:56:39.903501 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m15:56:39.903641 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m15:56:39.903797 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "cosmos"."dbt"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "cosmos"."dbt"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
[0m15:56:39.903950 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "cosmos"."dbt"."stg_payments__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "cosmos"."dbt"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
[0m15:56:39.904106 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "cosmos"."dbt"."stg_orders__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "cosmos"."dbt"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
[0m15:56:39.905187 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:56:39.905349 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:56:39.905514 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:56:39.908218 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m15:56:39.909295 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m15:56:39.910269 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m15:56:39.910410 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "cosmos"."dbt"."stg_orders" rename to "stg_orders__dbt_backup"
[0m15:56:39.910549 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "cosmos"."dbt"."stg_customers" rename to "stg_customers__dbt_backup"
[0m15:56:39.910678 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "cosmos"."dbt"."stg_payments" rename to "stg_payments__dbt_backup"
[0m15:56:39.911601 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:56:39.911724 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:56:39.912834 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m15:56:39.912962 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:56:39.913863 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m15:56:39.914001 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "cosmos"."dbt"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m15:56:39.914912 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m15:56:39.915059 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "cosmos"."dbt"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m15:56:39.915237 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "cosmos"."dbt"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:56:39.915837 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:56:39.915980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:56:39.916117 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:56:39.922681 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m15:56:39.923276 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m15:56:39.923798 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m15:56:39.923940 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m15:56:39.924065 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m15:56:39.924186 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m15:56:39.924308 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m15:56:39.924428 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m15:56:39.924549 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m15:56:39.928096 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:56:39.928231 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m15:56:39.930550 [debug] [Thread-1 (]: Applying DROP to: "cosmos"."dbt"."stg_customers__dbt_backup"
[0m15:56:39.930699 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m15:56:39.931412 [debug] [Thread-2 (]: Applying DROP to: "cosmos"."dbt"."stg_orders__dbt_backup"
[0m15:56:39.933361 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m15:56:39.934072 [debug] [Thread-3 (]: Applying DROP to: "cosmos"."dbt"."stg_payments__dbt_backup"
[0m15:56:39.934332 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m15:56:39.934469 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "cosmos"."dbt"."stg_customers__dbt_backup" cascade
[0m15:56:39.934726 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m15:56:39.934859 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "cosmos"."dbt"."stg_orders__dbt_backup" cascade
[0m15:56:39.935011 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "cosmos"."dbt"."stg_payments__dbt_backup" cascade
[0m15:56:39.937916 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:56:39.938793 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m15:56:39.939406 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m15:56:39.939542 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m15:56:39.939985 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m15:56:39.940505 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m15:56:39.940939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86ef4fb1-cc8b-4d98-afe1-6de845478e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077dfe90>]}
[0m15:56:39.941067 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86ef4fb1-cc8b-4d98-afe1-6de845478e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c62b0>]}
[0m15:56:39.941226 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86ef4fb1-cc8b-4d98-afe1-6de845478e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10569e850>]}
[0m15:56:39.941438 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt.stg_customers ............................. [[32mCREATE VIEW[0m in 0.07s]
[0m15:56:39.941647 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt.stg_orders ................................ [[32mCREATE VIEW[0m in 0.07s]
[0m15:56:39.942131 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m15:56:39.941949 [info ] [Thread-3 (]: 3 of 5 OK created sql view model dbt.stg_payments .............................. [[32mCREATE VIEW[0m in 0.07s]
[0m15:56:39.942372 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m15:56:39.942617 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m15:56:39.942922 [debug] [Thread-1 (]: Began running node model.jaffle_shop.orders
[0m15:56:39.943066 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m15:56:39.943255 [info ] [Thread-1 (]: 5 of 5 START sql table model dbt.orders ........................................ [RUN]
[0m15:56:39.943454 [info ] [Thread-4 (]: 4 of 5 START sql table model dbt.customers ..................................... [RUN]
[0m15:56:39.943625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.orders)
[0m15:56:39.943811 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.jaffle_shop.customers'
[0m15:56:39.943947 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.orders
[0m15:56:39.944075 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m15:56:39.945412 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.orders"
[0m15:56:39.946724 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m15:56:39.947024 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.orders
[0m15:56:39.952263 [debug] [Thread-1 (]: Applying DROP to: "cosmos"."dbt"."orders__dbt_backup"
[0m15:56:39.953363 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.orders"
[0m15:56:39.953501 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */
drop table if exists "cosmos"."dbt"."orders__dbt_backup" cascade
[0m15:56:39.953655 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m15:56:39.953801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:39.955614 [debug] [Thread-4 (]: Applying DROP to: "cosmos"."dbt"."customers__dbt_backup"
[0m15:56:39.955935 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.customers"
[0m15:56:39.956058 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop table if exists "cosmos"."dbt"."customers__dbt_backup" cascade
[0m15:56:39.956170 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:56:39.963920 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m15:56:39.964072 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m15:56:39.968157 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m15:56:39.968705 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.orders"
[0m15:56:39.969121 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.customers"
[0m15:56:39.969273 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.orders"
[0m15:56:39.969399 [debug] [Thread-4 (]: On model.jaffle_shop.customers: BEGIN
[0m15:56:39.969523 [debug] [Thread-1 (]: On model.jaffle_shop.orders: BEGIN
[0m15:56:39.970484 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m15:56:39.970648 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m15:56:39.970768 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.orders"
[0m15:56:39.970881 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.customers"
[0m15:56:39.971018 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */

  
    

  create  table "cosmos"."dbt"."orders__dbt_tmp"
  
  
    as
  
  (
    

with orders as (

    select * from "cosmos"."dbt"."stg_orders"

),

payments as (

    select * from "cosmos"."dbt"."stg_payments"

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final
  );
  
[0m15:56:39.971182 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  
    

  create  table "cosmos"."dbt"."customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (

    select * from "cosmos"."dbt"."stg_customers"

),

orders as (

    select * from "cosmos"."dbt"."stg_orders"

),

payments as (

    select * from "cosmos"."dbt"."stg_payments"

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
  
[0m15:56:39.976927 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.006 seconds
[0m15:56:39.977074 [debug] [Thread-4 (]: SQL status: SELECT 100 in 0.006 seconds
[0m15:56:39.979753 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.orders"
[0m15:56:39.980746 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.customers"
[0m15:56:39.980873 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */
alter table "cosmos"."dbt"."orders" rename to "orders__dbt_backup"
[0m15:56:39.980995 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "cosmos"."dbt"."customers" rename to "customers__dbt_backup"
[0m15:56:39.981463 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:56:39.981589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:56:39.982456 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.customers"
[0m15:56:39.985164 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.orders"
[0m15:56:39.985300 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "cosmos"."dbt"."customers__dbt_tmp" rename to "customers"
[0m15:56:39.985429 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */
alter table "cosmos"."dbt"."orders__dbt_tmp" rename to "orders"
[0m15:56:39.985775 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:56:39.985907 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:56:39.986461 [debug] [Thread-1 (]: On model.jaffle_shop.orders: COMMIT
[0m15:56:39.986951 [debug] [Thread-4 (]: On model.jaffle_shop.customers: COMMIT
[0m15:56:39.987078 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.orders"
[0m15:56:39.987213 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.customers"
[0m15:56:39.987333 [debug] [Thread-1 (]: On model.jaffle_shop.orders: COMMIT
[0m15:56:39.987446 [debug] [Thread-4 (]: On model.jaffle_shop.customers: COMMIT
[0m15:56:39.990877 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m15:56:39.991013 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:56:39.991707 [debug] [Thread-4 (]: Applying DROP to: "cosmos"."dbt"."customers__dbt_backup"
[0m15:56:40.016285 [debug] [Thread-1 (]: Applying DROP to: "cosmos"."dbt"."orders__dbt_backup"
[0m15:56:40.016628 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.customers"
[0m15:56:40.016890 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.orders"
[0m15:56:40.017034 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop table if exists "cosmos"."dbt"."customers__dbt_backup" cascade
[0m15:56:40.017164 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "airflow_db", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */
drop table if exists "cosmos"."dbt"."orders__dbt_backup" cascade
[0m15:56:40.021624 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:56:40.022295 [debug] [Thread-1 (]: On model.jaffle_shop.orders: Close
[0m15:56:40.022526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86ef4fb1-cc8b-4d98-afe1-6de845478e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083715d0>]}
[0m15:56:40.022763 [info ] [Thread-1 (]: 5 of 5 OK created sql table model dbt.orders ................................... [[32mSELECT 99[0m in 0.08s]
[0m15:56:40.022978 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.orders
[0m15:56:40.023105 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:56:40.023601 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m15:56:40.023784 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86ef4fb1-cc8b-4d98-afe1-6de845478e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10845f2a0>]}
[0m15:56:40.023981 [info ] [Thread-4 (]: 4 of 5 OK created sql table model dbt.customers ................................ [[32mSELECT 100[0m in 0.08s]
[0m15:56:40.024188 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m15:56:40.024693 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:40.024801 [debug] [MainThread]: On master: BEGIN
[0m15:56:40.024894 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:56:40.028762 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:56:40.028901 [debug] [MainThread]: On master: COMMIT
[0m15:56:40.028999 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:40.029091 [debug] [MainThread]: On master: COMMIT
[0m15:56:40.029380 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:56:40.029491 [debug] [MainThread]: On master: Close
[0m15:56:40.029617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:40.029711 [debug] [MainThread]: Connection 'model.jaffle_shop.orders' was properly closed.
[0m15:56:40.029795 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m15:56:40.029897 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m15:56:40.029984 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m15:56:40.030109 [info ] [MainThread]: 
[0m15:56:40.030229 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m15:56:40.030679 [debug] [MainThread]: Command end result
[0m15:56:40.040152 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/manifest.json
[0m15:56:40.040902 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/semantic_manifest.json
[0m15:56:40.043262 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/hemchheda/hem/airflow-dbt-cosmos/cosmos-demo/dbt/jaffle_shop/target/run_results.json
[0m15:56:40.043389 [info ] [MainThread]: 
[0m15:56:40.043532 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:56:40.043645 [info ] [MainThread]: 
[0m15:56:40.043765 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:56:40.044940 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5808775, "process_in_blocks": "0", "process_kernel_time": 0.174953, "process_mem_max_rss": "127041536", "process_out_blocks": "0", "process_user_time": 0.855757}
[0m15:56:40.045102 [debug] [MainThread]: Command `dbt run` succeeded at 15:56:40.045068 after 0.58 seconds
[0m15:56:40.045253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10521c2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b3950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b38f0>]}
[0m15:56:40.045389 [debug] [MainThread]: Flushing usage events
[0m15:56:41.475082 [debug] [MainThread]: An error was encountered while trying to flush usage events
